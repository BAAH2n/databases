Я створив базу даних, що симулює соціальну мережу з трьох таблиць: users, posts та comments, - кожна з яких містить один мільйон рядків.

Бізнес-задача полягала в отриманні детального звіту по кожному окремому коментарю, залишеному під постами авторів з Німеччини. Для кожного такого коментаря звіт мав показувати текст самого коментаря, текст поста, ім'я автора поста, середню кількість лайків на пост для автора цього коментаря (avg_likes_on_comment_author) та загальну кількість постів, написаних автором оригінального поста (quantity_of_posts_by_author).

У першому (неоптимізованому) варіанті програма працює дуже довго, через те, що їй треба для кожного користувача прлистувати всі табличк по 1000000 рядків, а таких користувачів теж 1000000, що робить це дуже довгою задачою.

У другому варіанті я оптимізував це, добавивши тимчасову табличку (CTE), де я зарання порахував середню кількість лайків та постів для кожного юзера, що дало змогу надалі просто обʼєднати через JOIN ці дані з іншими табличками, що значно скоротило нам час
